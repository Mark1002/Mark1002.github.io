<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;mark1002.github.io&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Mist&quot;,&quot;version&quot;:&quot;8.4.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:false,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:false,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜尋...&quot;,&quot;empty&quot;:&quot;我們無法找到任何有關 ${query} 的搜索結果&quot;,&quot;hits_time&quot;:&quot;${hits} 找到 ${time} 個結果&quot;,&quot;hits&quot;:&quot;找到 ${hits} 個結果&quot;}}</script>
<meta property="og:type" content="website">
<meta property="og:title" content="Mark&#39;s blog">
<meta property="og:url" content="http://mark1002.github.io/page/3/index.html">
<meta property="og:site_name" content="Mark&#39;s blog">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="Mark Chang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://mark1002.github.io/page/3/">



<script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:true,&quot;isPost&quot;:false,&quot;lang&quot;:&quot;zh-TW&quot;,&quot;comments&quot;:&quot;&quot;,&quot;permalink&quot;:&quot;&quot;,&quot;path&quot;:&quot;page&#x2F;3&#x2F;index.html&quot;,&quot;title&quot;:&quot;&quot;}</script>

<script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script>
<title>Mark's blog</title><script src="/js/config.js"></script>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Mark's blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>關於</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔</a></li>
        <li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>網站地圖</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Mark Chang"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Mark Chang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">36</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/mark1002" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;mark1002" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ak0922747401@gmail.com" title="E-Mail → mailto:ak0922747401@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="回到頂端">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/mark1002" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://mark1002.github.io/2018/04/04/python-%E7%B9%BC%E6%89%BF%E6%A9%9F%E5%88%B6%E7%A0%94%E7%A9%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mark Chang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mark's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/04/04/python-%E7%B9%BC%E6%89%BF%E6%A9%9F%E5%88%B6%E7%A0%94%E7%A9%B6/" class="post-title-link" itemprop="url">python 繼承機制研究</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2018-04-04 12:29:54" itemprop="dateCreated datePublished" datetime="2018-04-04T12:29:54+08:00">2018-04-04</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-01-24 19:13:35" itemprop="dateModified" datetime="2023-01-24T19:13:35+08:00">2023-01-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/04/04/python-%E7%B9%BC%E6%89%BF%E6%A9%9F%E5%88%B6%E7%A0%94%E7%A9%B6/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/04/04/python-繼承機制研究/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>今天遇到了一個 python 程式語言繼承機制的問題，如以下程式碼所示，可以發現子類別 <code>SuperMan</code> 同時繼承了兩個父類別 <code>Woman</code>、<code>Man</code>，而且這兩個父類別中都有一個叫 <code>foo</code> 的方法，那 <code>SuperMan</code> 到底會繼承哪一個並呼叫呢 ?</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Woman</span>:</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;I am a woman&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Man</span>:</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;I am man&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SuperMan</span>(<span class="params">Woman, Man</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">SuperMan.foo()</span><br></pre></td></tr></table></figure>
<p>執行結果如以下，答案是會先呼叫在類別繼承括號中最左邊的的 <code>Woman</code> 類別的方法<code>foo</code>。若把兩個父類別順序對換，則這次會先從 <code>Man</code>開始執行。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">I</span> am <span class="selector-tag">a</span> woman</span><br></pre></td></tr></table></figure>
<p>而為什麼會這樣執行而不會出錯呢？這個背後的機制就是 python 的繼承順序機制演算法 MRO（Method Resolution Order）定義了繼承的走訪順序，執行以下的程式碼可以看到 MRO 裡面的類別繼承內容。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(SuperMan.mro())</span><br></pre></td></tr></table></figure>
<p>可以發現從最左邊 <code>SuperMan</code> 自己開始，後一個類別就是 <code>Woman</code> 、<code>Man</code>、<code>object</code>，這裏要注意的是 python 的類別也是一種物件，因此繼承鍊最後也會指向到<code>object</code>。</p>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[&lt;class &#x27;__main__.SuperMan&#x27;&gt;, &lt;class &#x27;__main__.Woman&#x27;&gt;, &lt;class &#x27;__main__.Man&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;]</span></span><br></pre></td></tr></table></figure>
<p>而 MRO 的繼承順序行為背後是有一個 python 的 C3 演算法來實作的，C3 演算法是 python3 的繼承順序機制，這個演算法改進了過去 python2 繼承演算法的問題，結合了 DFS 與 BFS的優缺點，關於 MRO 的詳細過往可以參考<a target="_blank" rel="noopener" href="https://read01.com/kRkykj.html">這篇文章的介紹</a>。<br>接著修改了以上的程式如下，在 <code>Woman</code> 、<code>Man</code> 之上又共同繼承了<code>Human</code> 類別，形成了一個棱形繼承的結構，那麼繼承順序會變得如何呢？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Human</span>:</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;I am a human&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Woman</span>(<span class="params">Human</span>):</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">         <span class="built_in">print</span>(<span class="string">&quot;I am a woman&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Man</span>(<span class="params">Human</span>):</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;I am man&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SuperMan</span>(<span class="params">Woman, Man</span>):</span></span><br><span class="line">   <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">SuperMan.foo()</span><br><span class="line"><span class="built_in">print</span>(SuperMan.mro())</span><br></pre></td></tr></table></figure>
<p>程式執行結果如下：</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">I am a woman</span><br><span class="line">[&lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.SuperMan&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.Woman&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.Man&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.Human&#x27;</span>&gt;,&lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;]</span><br></pre></td></tr></table></figure>
<p>如果是在棱形繼承的結構之下，<strong>MRO 的行為會類似 BFS</strong> ，從左邊開始以廣度優先的順序來繼承節點。</p>
<img src="/2018/04/04/python-%E7%B9%BC%E6%89%BF%E6%A9%9F%E5%88%B6%E7%A0%94%E7%A9%B6/image1.png" class="">
<p>然而在不是棱形繼承的結構，而是一般的繼承結構又會如何呢？ 這裏更改以上的程式如下，移除 <code>Man</code> 與 <code>Human</code> 的繼承關係。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Human</span>:</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;I am a human&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Woman</span>(<span class="params">Human</span>):</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">         <span class="built_in">print</span>(<span class="string">&quot;I am a woman&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Man</span>:</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span>():</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;I am man&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SuperMan</span>(<span class="params">Woman, Man</span>):</span></span><br><span class="line">   <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">SuperMan.foo()</span><br><span class="line"><span class="built_in">print</span>(SuperMan.mro())</span><br></pre></td></tr></table></figure>
<p>程式的執行結果會改變如下：</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">I am a woman</span><br><span class="line">[&lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.SuperMan&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.Woman&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.Human&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.Man&#x27;</span>&gt;,&lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;]</span><br></pre></td></tr></table></figure>
<p>可以發現繼承的行為改變了！原本繼承 <code>Woman</code> 之後繼承 <code>Man</code> 現在卻變成了繼承 <code>Human</code>，<strong>MRO 在非棱形的繼承結構的行為會與 DFS 相同</strong>，變成從左到右以深度優先的方式來繼承節點。</p>
<img src="/2018/04/04/python-%E7%B9%BC%E6%89%BF%E6%A9%9F%E5%88%B6%E7%A0%94%E7%A9%B6/image2.png" class="">
<p>reference:<br><a target="_blank" rel="noopener" href="https://makina-corpus.com/blog/metier/2014/python-tutorial-understanding-python-mro-class-search-path">https://makina-corpus.com/blog/metier/2014/python-tutorial-understanding-python-mro-class-search-path</a><br><a target="_blank" rel="noopener" href="https://www.python-course.eu/python3_multiple_inheritance.php">https://www.python-course.eu/python3_multiple_inheritance.php</a><br><a target="_blank" rel="noopener" href="https://read01.com/kRkykj.html">https://read01.com/kRkykj.html</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://mark1002.github.io/2018/02/10/Duck-typeing-in-python/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mark Chang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mark's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/02/10/Duck-typeing-in-python/" class="post-title-link" itemprop="url">Duck typeing in python</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2018-02-10 16:44:09" itemprop="dateCreated datePublished" datetime="2018-02-10T16:44:09+08:00">2018-02-10</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-01-24 19:13:35" itemprop="dateModified" datetime="2023-01-24T19:13:35+08:00">2023-01-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/02/10/Duck-typeing-in-python/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/02/10/Duck-typeing-in-python/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>duck typeing 是程式語言的一種不需要用到繼承就可以有多型的特性。像 python 這種弱型別語言就有 duck typeing，以下程式碼展示了 duck typeing 的狀況：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Duck</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">scream</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Cuack!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">walk</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Walking like a duck...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">scream</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Ahhh!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">walk</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Walking like a human...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">activate</span>(<span class="params">duck</span>):</span></span><br><span class="line">    duck.scream()</span><br><span class="line">    duck.walk()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    Donald = Duck()</span><br><span class="line">    John = Person()</span><br><span class="line">    activate(Donald)</span><br><span class="line">    <span class="comment"># this is not supported in other languages, because John</span></span><br><span class="line">    <span class="comment"># is not a Duck object</span></span><br><span class="line">    activate(John)</span><br></pre></td></tr></table></figure>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Cuack!</span><br><span class="line"><span class="function"><span class="title">Walking</span></span> like a duck...</span><br><span class="line">Ahhh!</span><br><span class="line"><span class="function"><span class="title">Walking</span></span> like a human...</span><br></pre></td></tr></table></figure>
<p>程式中函式 activate 接收了 duck 物件當作參數並呼叫其中的方法，但由於 python 是弱型別語言，<br>可以發現函式 activate 不管接收哪種物件，只要物件中有跟 Duck 類別有一樣同名的方法，這些方法都會呼叫。強型別語言由於要在編譯前就嚴格指定參數的型別因此不會有 duck typeing 這個問題。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://mark1002.github.io/2018/01/14/PCA%E5%AD%B8%E7%BF%92%E8%88%87%E6%87%89%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mark Chang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mark's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/01/14/PCA%E5%AD%B8%E7%BF%92%E8%88%87%E6%87%89%E7%94%A8/" class="post-title-link" itemprop="url">PCA學習與應用</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2018-01-14 15:46:35" itemprop="dateCreated datePublished" datetime="2018-01-14T15:46:35+08:00">2018-01-14</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-01-24 19:13:35" itemprop="dateModified" datetime="2023-01-24T19:13:35+08:00">2023-01-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/data-science/" itemprop="url" rel="index"><span itemprop="name">data science</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2018/01/14/PCA%E5%AD%B8%E7%BF%92%E8%88%87%E6%87%89%E7%94%A8/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/01/14/PCA學習與應用/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>PCA 是一種特徵提取的技術，利用特徵降維來萃取出資料中最有代表性的主成分。而要注意的是 PCA 並不是從原本資料特徵中捨棄不重要的特徵來降維，而是由這些特徵與特徵向量 (eigenvector) 的線性組合所產生的新特徵來代表原本的資料。</p>
<p><img src="https://i.imgur.com/Ddhov6x.png"></p>
<p>X 表示一個 <strong>n x d</strong> 的資料集，n 是紀錄數，d 是資料維度也是特徵數，而 W 就是由 X 的共變異數矩陣所計算出來的特徵向量矩陣，<strong>d x k</strong> 維，其中 1 &lt;= k &lt;= d ，k 就是指定的主成分數，即表示要留下來的特徵向量個數， <strong>X*W 就是 PCA 計算結果</strong>，矩陣的維度變為 <strong>(n x d)*(d x k)=n x k</strong> ，如此達到降維的效果。</p>
<p><img src="https://i.imgur.com/hZH712X.png"></p>
<h3 id="PCA-演算法步驟"><a href="#PCA-演算法步驟" class="headerlink" title="PCA 演算法步驟"></a>PCA 演算法步驟</h3><ol>
<li>標準化 d 維原資料集</li>
<li>建立共變異數矩陣(covariance matrix)</li>
<li>分解共變異數矩陣(covariance matrix)為特徵向量(eigenvector)與特徵值(eigenvalues)。</li>
<li>選取 k 個最大特徵值(eigenvalues)相對應k個的特徵向量(eigenvector)，其中 k 即為新特徵子空間的維數。</li>
<li>使用排序最上面的 k 個的特徵向量(eigenvector)，建立投影矩陣(project matrix)W。</li>
<li>使用投影矩陣(project matrix) W 轉換原本 d 維的原數據至新的 k 維特徵子空間。</li>
</ol>
<h3 id="PCA-異常偵測"><a href="#PCA-異常偵測" class="headerlink" title="PCA 異常偵測"></a>PCA 異常偵測</h3><p>PCA 本質上可以想成一個將資料去除雜質的方法，因此可以藉由比較資料去除雜質的差異，來找出這些雜質 (異常)。首先，可以簡單想成 PCA 是由一個原本矩陣 X 乘上投影矩陣 W 得到的結果。因此當然也就可以從 PCA 的結果乘上 W 的轉置矩陣來還原到原本的矩陣空間。因此得到以下公式:</p>
<p>$$\underset{n\times k}{Z} = \underset{n\times d}{X} \times\underset{d\times k}{W}$$</p>
<p>$$\underset{n\times d}{\bar{X}} = \underset{n\times k}{Z}\times\underset{k\times d}{W^\top}$$</p>
<p>$\underset{n\times d}{\bar{X}}$ 就是從 PCA 空間還原的結果，而計算異常的方式就是計算 $\underset{n\times d}{\bar{X}}$ 與 $\underset{n\times d}{X}$ 兩者的歐式距離，即所謂的 <strong>reconstruction error</strong> ，如下圖所示新的測試資料點與經過 PCA 還原的點的距離就是該點的 reconstruction error，距離越大表示越有可能為異常。</p>
<p><img src="https://i.stack.imgur.com/1j5X1.png=100x100"></p>
<h3 id="PCA-異常偵測缺點"><a href="#PCA-異常偵測缺點" class="headerlink" title="PCA 異常偵測缺點"></a>PCA 異常偵測缺點</h3><ol>
<li>不適合在資料量大的情況，拿全部的訓練資料來進行矩陣計算，資料量大時極耗運算資源。</li>
<li>reconstruction error 必須要自行定義 threshold 值來判斷正常或是異常，無法自動得知。</li>
</ol>
<p>參考資料:<br><a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/259806/anomaly-detection-using-pca-reconstruction-error">https://stats.stackexchange.com/questions/259806/anomaly-detection-using-pca-reconstruction-error</a><br><a target="_blank" rel="noopener" href="https://www.kaggle.com/ericlikedata/reconstruct-error-of-pca/data">https://www.kaggle.com/ericlikedata/reconstruct-error-of-pca/data</a><br><a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/229092/how-to-reverse-pca-and-reconstruct-original-variables-from-several-principal-com">https://stats.stackexchange.com/questions/229092/how-to-reverse-pca-and-reconstruct-original-variables-from-several-principal-com</a><br><a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/2691/making-sense-of-principal-component-analysis-eigenvectors-eigenvalues">https://stats.stackexchange.com/questions/2691/making-sense-of-principal-component-analysis-eigenvectors-eigenvalues</a><br><a target="_blank" rel="noopener" href="http://arbu00.blogspot.tw/2017/02/6-principal-component-analysispca.html">http://arbu00.blogspot.tw/2017/02/6-principal-component-analysispca.html</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://mark1002.github.io/2017/12/24/docker-%E6%8C%87%E4%BB%A4%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mark Chang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mark's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2017/12/24/docker-%E6%8C%87%E4%BB%A4%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/" class="post-title-link" itemprop="url">docker 指令基本操作</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2017-12-24 16:13:53" itemprop="dateCreated datePublished" datetime="2017-12-24T16:13:53+08:00">2017-12-24</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-01-24 19:13:35" itemprop="dateModified" datetime="2023-01-24T19:13:35+08:00">2023-01-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2017/12/24/docker-%E6%8C%87%E4%BB%A4%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/12/24/docker-指令基本操作/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>記錄一些常用的 docker 指令以備不時之需。</p>
<ol>
<li><p>從 Dockerfile 的所在位置建立 image。</p>
 <figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$docker build -t imagename:<span class="keyword">tag</span> <span class="title">.</span></span><br></pre></td></tr></table></figure>
<ul>
<li>build 指令參數 <code>-t</code> 用來指定新建立 image 的名稱與 tag。</li>
<li>後面這個點 <code>.</code>表示 Dockerfile 所在的當前目錄，也表示要給 docker daemon build 的 context 路徑，只有在這個路徑之下檔案才會被正確的複製給 docker daemon 來製作 </li>
</ul>
</li>
<li><p>執行 docker image，這個指令會產生一個 container 來運行該 image</p>
 <figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$docker</span> <span class="builtin-name">run</span> --rm -it -p 8000:8000 imagename:tag</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-it</code>表示顯示出 terminal 的交互環境。</li>
<li><code>-p &lt;server port&gt;:&lt;container port&gt;</code> run 指令的數值參數，把主機的通訊埠所有流量轉發到 container 的通訊埠。</li>
</ul>
</li>
<li><p>將 image 發佈到 dockerhub 中。</p>
 <figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$docker</span> login -u <span class="variable">&lt;username&gt;</span> -p <span class="variable">&lt;password&gt;</span></span><br><span class="line"><span class="variable">$docker</span> <span class="keyword">tag</span> imagename:<span class="keyword">tag</span> namespace/imagename</span><br><span class="line"><span class="variable">$docker</span> push namespace/imagename</span><br></pre></td></tr></table></figure>
<ul>
<li>首先需要登入個人的 dockerhub 帳號，接著用 <code>tag</code> 指令來指定要用哪個 local image 來 push 到 dockerhub 上，<code>namespace</code> 就是對應的個人帳號。</li>
<li>接著在執行 <code>push</code> 指令就可以發佈了。</li>
</ul>
</li>
</ol>
<p>參考資料：<br><a target="_blank" rel="noopener" href="https://www.gitbook.com/book/yeasy/docker_practice/details">https://www.gitbook.com/book/yeasy/docker_practice/details</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://mark1002.github.io/2017/11/24/Transfer-Learning/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mark Chang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mark's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2017/11/24/Transfer-Learning/" class="post-title-link" itemprop="url">Transfer Learning 學習紀錄</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2017-11-24 22:32:56" itemprop="dateCreated datePublished" datetime="2017-11-24T22:32:56+08:00">2017-11-24</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-01-24 19:13:35" itemprop="dateModified" datetime="2023-01-24T19:13:35+08:00">2023-01-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/deep-learning/" itemprop="url" rel="index"><span itemprop="name">deep learning</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2017/11/24/Transfer-Learning/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/11/24/Transfer-Learning/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Transfer learning 是一個在機器學習領域的研究議題，大意是指將一個在某一種任務上學習 model 的知識可以轉移給其他的 model ，來去解不同但相近的任務，藉此來降低重新學習的成本。本人看到這種方法第一個聯想就好像是武俠小說中，一般人吃了25年功力的大還丹就變成絕世高手一樣…..</p>
<p>其中，Transfer learning 在深度學習的 CNN 更是用的火熱。因為深度學習的方法要訓練一個完好的模型所要花費的時間成本、資料量是非常貴的，以影像分類任務來說至少也要收集幾十萬張相關照片，來訓練個好幾天才會有好的結果，然而現實中根本不可能有那麼多大量的資料，因此在實務上深度學習的應用已很少完全重頭訓練模型，而是利用 transfer learning 來做 pre-training 任務。</p>
<p>Transfer learning 的應用上共有兩種：</p>
<ol>
<li>Feature extractor<br>此應用將整個預訓練的 CNN 視為一個 feature extractor，去掉後面的 fully-connected layer，保留前面的捲積層部分當作固定的特徵萃取器，圖片經過捲積層部分的萃取過程後得到的新特徵叫做 <code>CNN codes</code>，之後在接上一個線性的分類器來做分類。</li>
<li>Fine-tune<br>此方法除了也將預訓練 CNN 模型後面的 fully-connected layer 去掉以外，也對前面的一部分捲積層做權重的微調，其他捲積層則固定權重不變，進而重新訓練模型來更新權重，微調的網路層深淺視使用情境而定，一般而言較深的網路層會有較高層次抽象的特徵，離資料集本身的特性越接近，而淺的網路層則是比較泛化的特徵，像是線條、顏色等等。</li>
</ol>
<p>而使用 Transfer learning 的情境，會受到兩個關鍵因素所影響，分別是<strong>資料數量</strong>與<strong>資料相似性</strong>，因此根據這兩個關鍵因素共可分成以下四種使用策略，如以下這張圖所示：<br><img src="https://i.imgur.com/tk7QnUf.png"></p>
<ol>
<li><strong>New dataset is large and similar to the original dataset</strong><br>首先是圖中第一象限的情況，資料量多而且性質非常相似，這可以說是最好的情況了，由於資料量很多，因此不怕有 overfitting ，可以採取 fine-tune 對一部分捲積層做權重的微調來重新訓練整個網路。</li>
<li><strong>New dataset is large and very different from the original dataset</strong><br>第二象限資料量大且很不同，這種情況其實就可以直接從無到有訓練自己的CNN了，但實際上使用預訓練的網路模型來當作初始的權重還是有助益的，因此這種情況的訓練策略為使用預訓練模型的權重當作初始權重，之後再重新訓練整個網路。</li>
<li><strong>New dataset is small and similar to original dataset</strong><br>第三象限由於資料量極少，若採取 fine-tune 方式重新訓練整個網路會有 overfitting 的問題，然而訓練資料與預訓練模型的訓練資料非常相近，因此我們預期深的網路層的抽象特徵與資料本身特性夠接近，採取的作法為 feature extractor，得到 CNN codes 後在其後面接上一個線性分類器，並只訓練這個線性分類器來分類。</li>
<li><strong>New dataset is small but very different from the original dataset</strong><br>最後第四象限，資料量不但少且與預訓練模型的訓練資料差異極大，這時候由於資料量少，因此不適合使用 fine-tune 重新訓練整個網路，而將預訓練模型當成 feature extractor 呢？這裏要注意的是由於資料性質差異大，因此就不能使用後面網路的深層特徵了，因為這些特徵只與預訓練模型的資料性質很接近，但與要訓練的新資料特性可是天差地遠了，所以要做 feature extractor 的話，要抽取網路層前面較淺且較泛化的 CNN codes 當特徵，後面在接上線性分類器來訓練。</li>
</ol>
<p>除了以上兩種應用與四種情境以外，使用 Transfer learning 訓練需注意的另一點為要使用較小的 learning rate，這是因為預訓練模型卷積層的權重已有較好的調校，若使用過大的 learning rate 反而會把本來準確的權重給破壞了。</p>
<p>參考資料:<br><a target="_blank" rel="noopener" href="https://towardsdatascience.com/transfer-learning-using-keras-d804b2e04ef8">https://towardsdatascience.com/transfer-learning-using-keras-d804b2e04ef8</a><br><a target="_blank" rel="noopener" href="http://cs231n.github.io/transfer-learning/#tf">http://cs231n.github.io/transfer-learning/#tf</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://mark1002.github.io/2017/11/14/tensorflow-gpu%E5%9C%A8unbantu16-04%E7%92%B0%E5%A2%83%E5%BB%BA%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mark Chang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mark's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2017/11/14/tensorflow-gpu%E5%9C%A8unbantu16-04%E7%92%B0%E5%A2%83%E5%BB%BA%E7%BD%AE/" class="post-title-link" itemprop="url">tensorflow-gpu在unbantu16.04環境建置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2017-11-14 21:46:09" itemprop="dateCreated datePublished" datetime="2017-11-14T21:46:09+08:00">2017-11-14</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-01-24 19:13:35" itemprop="dateModified" datetime="2023-01-24T19:13:35+08:00">2023-01-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/tensorflow/" itemprop="url" rel="index"><span itemprop="name">tensorflow</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2017/11/14/tensorflow-gpu%E5%9C%A8unbantu16-04%E7%92%B0%E5%A2%83%E5%BB%BA%E7%BD%AE/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/11/14/tensorflow-gpu在unbantu16-04環境建置/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>這是我 tensorflow 在 unbantu 16.04 的安裝紀錄。</p>
<p>安裝套件版本：<br>tensorflow 1.3.0<br>cuda 8.0.61<br>cudnn 6.0 for cuda 8</p>
<p>從 <a target="_blank" rel="noopener" href="https://developer.nvidia.com/cuda-toolkit-archive">nvidia</a>下載 cuda 以及 cudnn 之後，在安裝前請重新開機進入 BIOS 設定把預設顯示卡功能調整成用內顯，並調整螢幕插頭位置到內顯插槽上，之後按下 <code>Ctrl-Alt-F1</code> 進入 tty1 介面，並輸入以下指令</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service lightdm stop</span><br></pre></td></tr></table></figure>
<p>根據<a target="_blank" rel="noopener" href="http://city.shaform.com/blog/2016/10/31/install-tensorflow-with-cuda.html">這篇</a>的說法這條指令的作用是用來達到顯示卡與內顯區別的目的，如果不打這條指令就裝 cuda 的話，重新開機後 unbantu 會畫面全黑或是卡在系統 loading 畫面。<br>(ps:本人就是這樣才重新裝第二次!)</p>
<p>之後就可以開始安裝 cuda 了，輸入以下安裝指令來安裝。這裡有一點要注意的是要指定 <code>cuda=version</code> 來安裝，不指定的話預設裝上的是 cuda9</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo dpkg --install cuda-repo-ubantu1604_8.0.61-1_amd64.deb</span><br><span class="line">$ sudo apt-<span class="builtin-name">get</span> update</span><br><span class="line">$ sudo apt-<span class="builtin-name">get</span> install <span class="attribute">cuda</span>=8.0.61-1</span><br></pre></td></tr></table></figure>
<p>裝完後到 <code>.bashrc</code> 貼上以下環境變數路徑，之後記得先重開機看看能不能順利入系統</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export PATH=<span class="variable">$PATH</span><span class="symbol">:/usr/local/cuda-</span><span class="number">8.0</span>/bin</span><br><span class="line">export LD_LIBRARY_PATH=<span class="regexp">/usr/local</span><span class="regexp">/cuda-8.0/lib</span>64</span><br></pre></td></tr></table></figure>
<p>接著開始來安裝 cudnn，輸入以下指令</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ tar -xvzf cudnn-<span class="number">8.0</span>-linux-x64-v6.<span class="number">0</span>.tgz</span><br><span class="line">$ sudo cp cuda<span class="regexp">/include/</span>cudnn.h <span class="regexp">/usr/</span>local<span class="regexp">/cuda/i</span>nclude</span><br><span class="line">$ sudo cp cuda<span class="regexp">/lib64/</span>libcudnn* <span class="regexp">/usr/</span>local<span class="regexp">/cuda/</span>lib64</span><br><span class="line">$ sudo chmod a+r <span class="regexp">/usr/</span>local<span class="regexp">/cuda/i</span>nclude<span class="regexp">/cudnn.h /u</span>sr<span class="regexp">/local/</span>cuda<span class="regexp">/lib64/</span>libcudnn*</span><br></pre></td></tr></table></figure>
<p>以上都裝好的話可以打以下指令來 check 顯卡是否有裝好</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>nvidia-smi</span><br></pre></td></tr></table></figure>

<p>之後就是裝 tensorflow 了，基本上都跟<a target="_blank" rel="noopener" href="https://www.tensorflow.org/install/install_linux">官網</a>一樣，沒什麼不同。<br>本人採用的是 Anaconda 的安裝環境，創一個虛擬的環境後打以下指令</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install https:<span class="regexp">//</span>storage.googleapis.com<span class="regexp">/tensorflow/</span>linux<span class="regexp">/gpu/</span>tensorflow_gpu-<span class="number">1.3</span>.<span class="number">0</span>-cp35-cp35m-linux_x86_64.whl</span><br></pre></td></tr></table></figure>

<p>到這邊就差不多裝好囉！之後就可以在裝 keras, pandas, numpy 等等其他資料分析常用的套件啦！</p>
<p>參考資料<br><a target="_blank" rel="noopener" href="http://city.shaform.com/blog/2016/10/31/install-tensorflow-with-cuda.html">http://city.shaform.com/blog/2016/10/31/install-tensorflow-with-cuda.html</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://mark1002.github.io/2017/09/19/NumPy-%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mark Chang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mark's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2017/09/19/NumPy-%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/" class="post-title-link" itemprop="url">NumPy 學習筆記</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2017-09-19 22:12:19" itemprop="dateCreated datePublished" datetime="2017-09-19T22:12:19+08:00">2017-09-19</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-01-24 19:13:35" itemprop="dateModified" datetime="2023-01-24T19:13:35+08:00">2023-01-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2017/09/19/NumPy-%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/09/19/NumPy-學習筆記/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>NumPy 乃是 python 做資料分析的一項重要的函式庫工具，因此有必要理解其底層的實現細節，本文將記錄我對 NumPy 資料結構的理解。首先，由於 python 本身的物件型別有限，很難去支援複雜的科學計算，因此就有了 NumPy 這個函式庫，藉由擴充更多的型態類別定義以支援更複雜的科學計算任務。首先介紹的是<code>ndarray</code>物件， 這是 NumPy 裡用來儲存數組的 container 結構，<code>ndarray</code> 的 size 是固定的，當<code>ndarray</code>物件建立時會分配一段固定大小的連續記憶體空間，同時 <code>ndarray</code> 也是同質性的，裡面的所存放的 items 也都是固定的 size 與 type。 而決定這一個<code>ndarray</code>陣列物件的資料型別是由另一個物件<code>dtype</code> 所決定。 每一個 <code>ndarray</code> 陣列中的 item 都會被視為獨立的<code>dtype</code>物件，<code>dtype</code>即定義<code>ndarray</code>中所存放的 item 是哪一種型別以及大小，關係示意圖如下圖所示：</p>
<img src="/2017/09/19/NumPy-%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/threefundamental.png" class="">
<p>其中，根據我的理解圖中的 array scalar 就是 <code>dtype</code> 所定義的資料型別，根據 NumPy 文件的定義共有 24 種。彼此間也有繼承的關係，如下圖所示：</p>
<img src="/2017/09/19/NumPy-%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/dtype-hierarchy.png" class="">
<p>可以看出最上層為一個 generic 型別，之後一一往下繼承並擴充，比如我們要 check float32 是否為 number 的子型別，可如下測試：<br>    &gt;&gt;&gt; np.issubdtype(np.float32, np.number)<br>    &gt;&gt;&gt; True</p>
<p>參考資料：<br><a target="_blank" rel="noopener" href="https://docs.scipy.org/doc/numpy/reference/arrays.html">https://docs.scipy.org/doc/numpy/reference/arrays.html</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://mark1002.github.io/2017/09/12/matplotlib-%E5%9C%A8-linux-%E7%92%B0%E5%A2%83%E4%B8%8B%E7%9A%84%E9%8C%AF%E8%AA%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mark Chang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mark's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2017/09/12/matplotlib-%E5%9C%A8-linux-%E7%92%B0%E5%A2%83%E4%B8%8B%E7%9A%84%E9%8C%AF%E8%AA%A4/" class="post-title-link" itemprop="url">matplotlib 在 linux 環境下的錯誤</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2017-09-12 22:30:26" itemprop="dateCreated datePublished" datetime="2017-09-12T22:30:26+08:00">2017-09-12</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-01-24 19:13:35" itemprop="dateModified" datetime="2023-01-24T19:13:35+08:00">2023-01-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2017/09/12/matplotlib-%E5%9C%A8-linux-%E7%92%B0%E5%A2%83%E4%B8%8B%E7%9A%84%E9%8C%AF%E8%AA%A4/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/09/12/matplotlib-在-linux-環境下的錯誤/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>遇到的問題為使用 python 的繪圖套件-matplotlib 在 linux 作業系統 unbantu 16.04 下所遇到的錯誤。錯誤畫面如下：</p>
<img src="/2017/09/12/matplotlib-%E5%9C%A8-linux-%E7%92%B0%E5%A2%83%E4%B8%8B%E7%9A%84%E9%8C%AF%E8%AA%A4/error1.png" class="" title="奇怪的錯誤">
<p>一開始以為是 race condition 的問題，但後來想想目前程式皆是用 single thread 去寫的，所以應該不是這個問題。<br>後來又測到了如以下的錯誤：</p>
<img src="/2017/09/12/matplotlib-%E5%9C%A8-linux-%E7%92%B0%E5%A2%83%E4%B8%8B%E7%9A%84%E9%8C%AF%E8%AA%A4/error2.png" class="" title="Segmentation fault! 這套件一定有問題.....">
<p>很明顯的可以發現繪圖套件本身極可能有問題。因此朝了此方向去 google 得知由於 matplotlib 預設是在有圖形使用者介面的環境運作的，需要有 X11 connection，然而很多的 web server 初始就設置 X11 connection ，因此直接轉移到伺服器環境常常會照成一些錯誤。參考了官網解法，加入以下程式碼即可解決。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># do this before importing pylab or pyplot</span></span><br><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line">matplotlib.use(<span class="string">&#x27;Agg&#x27;</span>)</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="方法更新"><a href="#方法更新" class="headerlink" title="方法更新"></a>方法更新</h1><p>目前的解法雖然程序不會當掉，每個request都有回應，<strong>但是指細檢查每個 request 回傳的內容還是發現裡面還是有 error 的！！！</strong></p>
<p>以下壓力測試以 jmeter 測量，Django 不加上 –nothreading 參數啟動server，同時開 100 thread 發送 request 給 Data Chart API ，django 雖然不會掛掉但可以發現結果圖形很不穩，</p>
<p><img src="https://i.imgur.com/8uZ5U4T.png"></p>
<p>在看檢視結果樹每個 request 的回傳結果是有錯誤的！！！</p>
<p><img src="https://i.imgur.com/Liki7cx.png"></p>
<p>這就是表示雖然有加了 matplotlib 設定檔來指定 Agg backend，但還是沒有解決 thread safe 的問題，每一個 request 同時顯示圖片會發生 race condition 問題！！導致繪圖套件圖片會出錯！</p>
<p>因此，我在繪圖的程式碼區塊上下加上了 lock 來建立 critical section 來解決 race condition 問題</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">lock.acquire()</span><br><span class="line"><span class="comment"># critical section</span></span><br><span class="line"><span class="comment"># 這裡是被保護的繪圖程式碼</span></span><br><span class="line">lock.release()</span><br></pre></td></tr></table></figure>

<p>加上之後再重新執行 jmeter，發現不但結果圖形變穩定，100 個 request 都有成功的回應！！！</p>
<p><img src="https://i.imgur.com/nG3M6oR.png"></p>
<p>每個 request 都有成功畫出圖片</p>
<p><img src="https://i.imgur.com/vIsBi24.png"></p>
<p>最後是執行 1000 個 thread 結果，加上 Lock 後服務變得很穩定</p>
<p><img src="https://i.imgur.com/08Ec68i.png"></p>
<p>因此加上 Lock 限制或許才是最終的解決之道。</p>
<p>參考資料：<br><a target="_blank" rel="noopener" href="https://matplotlib.org/faq/howto_faq.html">https://matplotlib.org/faq/howto_faq.html</a><br><a target="_blank" rel="noopener" href="https://www.lookfor404.com/%E8%BF%90%E8%A1%8Cggplot%E5%87%BA%E7%8E%B0%E9%97%AE%E9%A2%98no-display-name-and-no-display-environment-variable/">https://www.lookfor404.com/%E8%BF%90%E8%A1%8Cggplot%E5%87%BA%E7%8E%B0%E9%97%AE%E9%A2%98no-display-name-and-no-display-environment-variable/</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://mark1002.github.io/2016/01/29/javascript%E5%8E%9F%E5%9E%8B%E9%8F%88%E7%B9%BC%E6%89%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mark Chang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mark's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2016/01/29/javascript%E5%8E%9F%E5%9E%8B%E9%8F%88%E7%B9%BC%E6%89%BF/" class="post-title-link" itemprop="url">javascript原型鏈繼承</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2016-01-29 16:35:14" itemprop="dateCreated datePublished" datetime="2016-01-29T16:35:14+08:00">2016-01-29</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-01-24 19:13:35" itemprop="dateModified" datetime="2023-01-24T19:13:35+08:00">2023-01-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/javascript/" itemprop="url" rel="index"><span itemprop="name">javascript</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2016/01/29/javascript%E5%8E%9F%E5%9E%8B%E9%8F%88%E7%B9%BC%E6%89%BF/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/01/29/javascript原型鏈繼承/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>_proto_</strong><br>javascript 的物件導向繼承機制與其他靜態語言 java、c#、c++ 有很大的不同，javascript 是沒有所謂的 class 的，ECMAScript 6 中新介紹的 “class” 只是一種語法糖，並沒有改變原來的機制，實際上還是 Function Object。<br>javascript 的繼承機制是採用物件繼承物件的方式，即原型鍊繼承（Prototypal inheritance），當中的關鍵就是<code>_proto_</code>這個物件屬性，它就好像一個參照指標一樣，被參考的物件就是此物件的原型，例如<code>rabbit.__proto__ = animal </code> 物件<code>animal</code>就是物件<code>rabbit</code>的原型，物件<code>rabbit</code>繼承了物件<code>animal</code>，因此<code>rabbit</code>可以使用<code>animal</code>的<code>eat</code>方法，如圖所示</p>
<img src="/2016/01/29/javascript%E5%8E%9F%E5%9E%8B%E9%8F%88%E7%B9%BC%E6%89%BF/proto4.png" class="">
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> animal = &#123; <span class="attr">eats</span>: <span class="literal">true</span> &#125;</span><br><span class="line"><span class="keyword">var</span> rabbit = &#123; <span class="attr">jumps</span>: <span class="literal">true</span> &#125;</span><br><span class="line">rabbit.__proto__ = animal  <span class="comment">// inherit</span></span><br><span class="line">alert(rabbit.eats) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>而當物件與物件所繼承的parent原型物件皆有同名稱的 method 或屬性時，則呼叫本身的物件的那一個method 或屬性，如以下程式碼表示</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> animal = &#123; <span class="attr">eats</span>: <span class="literal">true</span> &#125;</span><br><span class="line"><span class="keyword">var</span> fedUpRabbit = &#123; <span class="attr">eats</span>: <span class="literal">false</span>&#125;</span><br><span class="line">fedUpRabbit.__proto__ = animal  </span><br><span class="line">alert(fedUpRabbit.eats) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>詳細的運作情形是javascript的原型鍊繼承有個往上查找的特性，當在本身物件內scope找不到某個屬性時，就會循著    <code>_proto_</code>指向的原型物件去做查找，像以下另一個例子，<code>rabbit</code> 呼叫了 <code>eat</code> method，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> animal = &#123;</span><br><span class="line">  <span class="attr">eat</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    alert( <span class="string">&quot;I&#x27;m full&quot;</span> )</span><br><span class="line">    <span class="built_in">this</span>.full = <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> rabbit = &#123; </span><br><span class="line">  <span class="attr">jump</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">/* something */</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rabbit.__proto__ = animal  </span><br><span class="line">rabbit.eat()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>而<code>rabbit</code>本身沒有這個 method，因此在執行的時候 interpreter 就會循著原型鍊往上查找，從原型中找到相應的 method並呼叫</p>
<img src="/2016/01/29/javascript%E5%8E%9F%E5%9E%8B%E9%8F%88%E7%B9%BC%E6%89%BF/proto5.png" class="">
<p>值得注意的是這邊的<code>this</code>是指<code>rabbit</code>物件，<code>rabbit</code>物件只是去 call parent method 而已，跟<code>_proto_</code>無關，因此執行完最後物件的結果圖會長以下這樣</p>
<img src="/2016/01/29/javascript%E5%8E%9F%E5%9E%8B%E9%8F%88%E7%B9%BC%E6%89%BF/proto6.png" class="">


<p>不過使用<code>__proto__</code>屬性並不適宜所有瀏覽器，因為它並不是一個共同標準，有些瀏覽器的只能內部讀取而已，並不能隨意跟改<code>__proto__</code>值，因此就有其他通用方法的出現。</p>
<p><strong>prototype</strong></p>
<p><code>prototype</code>就是一個跨瀏覽器常用的方法，不過他需要跟 constructor function 一起使用，像是以下程式碼</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rabbit</span>(<span class="params">name</span>) </span>&#123; </span><br><span class="line">  <span class="built_in">this</span>.name = name</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> rabbit = <span class="keyword">new</span> Rabbit(<span class="string">&#x27;John&#x27;</span>)</span><br><span class="line">alert(rabbit.name) <span class="comment">// John</span></span><br></pre></td></tr></table></figure>

<p>當呼叫了 new function call ，新的 Rabbit 物件就產生了，<strong>而此時 new 也會設定這個新產生物件的<code>__proto__</code>屬性指向這個建構子的 prototype 屬性</strong>，就像以下這樣</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> animal = &#123; <span class="attr">eats</span>: <span class="literal">true</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rabbit</span>(<span class="params">name</span>) </span>&#123; </span><br><span class="line">  <span class="built_in">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Rabbit.prototype = animal ;</span><br><span class="line"><span class="keyword">var</span> rabbit = <span class="keyword">new</span> Rabbit(<span class="string">&#x27;John&#x27;</span>);</span><br><span class="line">alert( rabbit.eats ); <span class="comment">// true, because rabbit.__proto__ == animal</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>Rabbit.prototype = animal</code>這段程式碼所要表達的意思就是將所有透過<code>new Rabbit</code>產生的物件的<code>__proto__</code>屬性全部指向<code>animal</code>這個物件並當成原型。</p>
<p>還有一點要注意的是，原型鍊在查找有無物件屬性時，只有該物件沒有該屬性時，才會使用原型的屬性，如果直接在物件上設定屬性的值是不會影響原型物件的屬性的，例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Some</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Some.prototype.data = <span class="number">10</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> Some();</span><br><span class="line"><span class="built_in">console</span>.log(s.data);                 <span class="comment">// 10</span></span><br><span class="line"> </span><br><span class="line">s.data = <span class="number">20</span>;</span><br><span class="line"><span class="built_in">console</span>.log(s.data);                 <span class="comment">// 20</span></span><br><span class="line"><span class="built_in">console</span>.log(Some.prototype.data);    <span class="comment">// 10</span></span><br></pre></td></tr></table></figure>

<p>以上這就是 javascript 原型鍊繼承的概念。</p>
<p>參考資料<br><a target="_blank" rel="noopener" href="http://javascript.info/tutorial/inheritance">http://javascript.info/tutorial/inheritance</a><br><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://mark1002.github.io/2015/11/22/jdbc%E8%A8%AD%E5%AE%9A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Mark Chang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Mark's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2015/11/22/jdbc%E8%A8%AD%E5%AE%9A/" class="post-title-link" itemprop="url">jdbc設定</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2015-11-22 23:04:47" itemprop="dateCreated datePublished" datetime="2015-11-22T23:04:47+08:00">2015-11-22</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-01-24 19:13:35" itemprop="dateModified" datetime="2023-01-24T19:13:35+08:00">2023-01-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2015/11/22/jdbc%E8%A8%AD%E5%AE%9A/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/11/22/jdbc設定/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>今天在設定jsp專案所遇到的問題，Eclipse一直遇到抓不到jdbc的mysql driver。上網花了一些時間查查原來是jsp要使用到jdbc driver，是要在 WEB-INF/lib裡面把driver的jar檔放入而不是傳統的在java Resource資料夾裡設定java library路徑。<br>如以下圖所示：</p>
<img src="/2015/11/22/jdbc%E8%A8%AD%E5%AE%9A/jdbc-path.png" class="" title="jdbc路徑位置">

<p>參考資料<br><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/17701610/cannot-find-or-load-oracle-jdbc-driver-oracledriver">http://stackoverflow.com/questions/17701610/cannot-find-or-load-oracle-jdbc-driver-oracledriver</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一頁"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一頁"></i></a>
  </nav>
<script src="/js/comments.js"></script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mark Chang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 強力驅動
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  




<script class="next-config" data-name="disqus" type="application/json">{&quot;enable&quot;:true,&quot;shortname&quot;:&quot;mark1002&quot;,&quot;count&quot;:true,&quot;i18n&quot;:{&quot;disqus&quot;:&quot;disqus&quot;}}</script>
<script src="/js/third-party/comments/disqus.js"></script>

</body>
</html>
